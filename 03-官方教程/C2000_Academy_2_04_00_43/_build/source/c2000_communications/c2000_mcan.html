
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>CAN Flexible Data Rate (CAN FD)/MCAN &#8212; C2000 Academy  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../../_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/local/font.css" />
    <link rel="stylesheet" type="text/css" href="https://www.ti.com/assets/fonts/font.css" />
    <link rel="stylesheet" type="text/css" href="https://www.ti.com/assets/style/resource-explorer.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94">
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/quizdown.js"></script>
    <script>quizdown.init({"quizdown_js": "quizdown.js", "start_on_load": true, "shuffle_answers": false, "shuffle_questions": false, "primary_color": "var(--pst-color-primary)", "secondary_color": "#DDDDDD", "text_color": "black"});</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'source/c2000_communications/c2000_mcan';</script>
    <script src="../../_static/quizdown.js"></script>
    <link rel="canonical" href="http://127.0.0.1:8000/source/c2000_communications/c2000_mcan.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Local Interconnect Network (LIN)" href="c2000_lin.html" />
    <link rel="prev" title="Controller Area Network (CAN)" href="c2000_can.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search C2000 Academy" aria-label="Search C2000 Academy" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    

    
    
  </div>

  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article"></div>
              
              
                <article class="bd-article" role="main">
                  
                  
<div id="searchbox"></div>
                  
  <section class="tex2jax_ignore mathjax_ignore" id="can-flexible-data-rate-can-fd-mcan">
<h1>CAN Flexible Data Rate (CAN FD)/MCAN<a class="headerlink" href="#can-flexible-data-rate-can-fd-mcan" title="Permalink to this heading">#</a></h1>
<p>This section assumes familiarity with the CAN protocol. Please refer to the
previous CAN section for an overview of CAN. CAN FD refers to the protocol
while MCAN refers to the physical module on the device that implements the CAN
FD protocol.</p>
<div class="admonition-mcan-module admonition">
<p class="admonition-title">MCAN Module</p>
<p>Not all C2000 devices have a MCAN module. Refer to the
<i><a class="reference external" href="https://www.ti.com/lit/spru566">Peripheral Reference Guide</a></i>
for a list of supported modules on your device.</p>
</div>
<section id="can-fd-advantages">
<h2>CAN FD Advantages<a class="headerlink" href="#can-fd-advantages" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Higher bandwidth and throughput</p></li>
<li><p>No change in data link layer reliability</p></li>
<li><p>No significant price increase (for the MCU or the transceiver)</p></li>
<li><p>Relatively easy to understand the protocol since it is an extension of the classic CAN</p></li>
</ul>
</section>
<section id="can-fd-mcan">
<h2>CAN FD (MCAN)<a class="headerlink" href="#can-fd-mcan" title="Permalink to this heading">#</a></h2>
<p><img alt="MCAN Intro" src="../../_images/MCAN_Intro.png" /></p>
<ul class="simple">
<li><p>Up to 64 bytes per frame</p></li>
<li><p>Bigger payload size reduces protocol overhead and improves the effective
bit-rate</p></li>
<li><p>Data field can be transmitted at bit rates up to 5 Mbps or more</p></li>
<li><p>High bit-rate aids applications like “Advanced Driver Assistance Systems”
(ADAS), Autonomous driving, and faster firmware updates</p></li>
</ul>
</section>
<section id="mcan-features">
<h2>MCAN Features<a class="headerlink" href="#mcan-features" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>MCAN module supports both classic CAN and CAN FD</p></li>
<li><p>Bit-rate support up to 10 Mbps</p></li>
<li><p>Configurable number of TX Queues/FIFO and RX buffers/FIFOs in the message RAM</p></li>
<li><p>No concept of mailboxes or message objects</p></li>
<li><p>Offers flexibility to take advantage of the available message RAM as required</p></li>
<li><p>Filter event support</p>
<ul>
<li><p>Any filter element match can trigger a system action like CLA task
trigger, PWM trip etc.</p></li>
</ul>
</li>
<li><p>Frame time-stamping support</p></li>
<li><p>ECC protection for message RAMs</p></li>
<li><p>Clock-stop and wake-up from another node</p></li>
<li><p>MCAN is <strong>not</strong> software compatible with DCAN</p></li>
</ul>
</section>
<section id="message-ram-configuration">
<h2>Message RAM Configuration<a class="headerlink" href="#message-ram-configuration" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Up to 32 dedicated <strong>Transmit</strong> buffers. Can be configured as,</p>
<ul>
<li><p>Dedicated TX Buffers</p></li>
<li><p>TX FIFO</p></li>
<li><p>TX Queue</p></li>
<li><p>Combination of dedicated TX buffers/TX FIFO</p></li>
<li><p>Combination of dedicated TX buffers/TX Queue</p></li>
</ul>
</li>
<li><p>Up to 64 dedicated <strong>Receive</strong> buffers</p></li>
<li><p>Two configurable <strong>Receive FIFOs</strong> (RX FIFO0 and RX FIFO1) with up to 64
element each.</p></li>
</ul>
</section>
<section id="transmitter-delay-compensation-tdc">
<h2>Transmitter Delay Compensation (TDC)<a class="headerlink" href="#transmitter-delay-compensation-tdc" title="Permalink to this heading">#</a></h2>
<p>TDC is a feature that has been introduced in CAN FD. It is not applicable to
classic CAN. In CAN protocol, any transmitting node monitors its own transmission.
This is required in order to facilitate non-destructive bit-wise arbitration,
ascertain acknowledgement of a frame (ACK) by other nodes and handle error frames.
One function of the CAN transceiver is to loop back the transmitted data into the
receive pin of the CAN module after a delay known as the transceiver loop delay.</p>
<p>All transmitters sample the transmitted data at the sample point (SP), the
intersection of TSEG1 and TSEG2, to verify correct transmission. Apart from
arbitration, this mechanism is needed to check for problems in the physical
layer and to detect other node’s error frames. In case the transmitter delay
is greater than TSEG1 (time segment before sample point), a bit error is
detected. In order to enable a data phase bit time that is even shorter than
the transmitter delay, the delay compensation is introduced. Without TDC, the
bit rate in the data phase of a CAN FD frame is limited by the transmitter
delay. In other words, TDC enables the support of higher bit-rates in the data
phase, where the nominal bit time may be shorter than the loop delay.</p>
<p><strong>Secondary Sample Point (SSP)</strong></p>
<p>During the data phase of transmitting nodes, the delayed transmit data is
compared against the received data at the Secondary Sample Point (SSP). The
SSP position is defined as the sum of the measured delay from the MCAN’s
transmit pin (MCAN_TX), through the transceiver to the receive pin (MCAN_RX)
plus a configurable transmitter delay compensation offset. The delay
measurement is started within each transmitted CAN FD frame at the falling
edge of bit FDF to bit “res”. It is stopped when this edge is seen at the
receive pin (MCAN_RX) of the transmitting node.</p>
<p><strong>Enabling transmitter delay compensation</strong></p>
<p>TDC is enabled by setting the TDC bit in DBTP register. Transmitter delay
compensation offset is configured by TDCR.TDCO which is used to adjust the
position of the SSP. To avoid that a dominant glitch inside the received
FDF bit ends the delay compensation measurement before the falling edge
of the received “res” bit, resulting in a too-early SSP position, the
use of a transmitter delay compensation filter window can be enabled by
programming TDCR.TDCF which defines a minimum value for the SSP position.
PSR.TDCV shows the actual transmitter delay compensation value.</p>
</section>
<section id="resources">
<h2>Resources<a class="headerlink" href="#resources" title="Permalink to this heading">#</a></h2>
<section id="mcan-related-collateral">
<h3>MCAN Related Collateral<a class="headerlink" href="#mcan-related-collateral" title="Permalink to this heading">#</a></h3>
<p><strong>Foundational</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.ti.com/video/6078637459001">CAN and CAN FD Overview</a></p></li>
<li><p><a class="reference external" href="https://www.ti.com/video/6078640832001">CAN and CAN FD Protocol</a> - Only applicable to: F280013x, F28002x, F28003x, F28004x, F2807x, F2837xD, F2837xS, F2838x</p></li>
</ul>
<p><strong>Getting Started</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.ti.com/lit/spracu9">Getting Started with the MCAN (CAN FD) Module Application Report</a> - Only applicable to: F28003x, F2838x</p></li>
</ul>
</section>
<hr class="docutils" />
<div class="admonition-feedback admonition">
<p class="admonition-title">Feedback</p>
<p>Please provide any feedback you may have about the content within C2000 Academy to: <a class="reference external" href="mailto:c2000_academy_feedback&#37;&#52;&#48;list&#46;ti&#46;com">c2000_academy_feedback<span>&#64;</span>list<span>&#46;</span>ti<span>&#46;</span>com</a></p>
</div>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="c2000_can.html" title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">Controller Area Network (CAN)</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="c2000_lin.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">Local Interconnect Network (LIN)</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc">
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#can-fd-advantages">
   CAN FD Advantages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#can-fd-mcan">
   CAN FD (MCAN)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mcan-features">
   MCAN Features
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#message-ram-configuration">
   Message RAM Configuration
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transmitter-delay-compensation-tdc">
   Transmitter Delay Compensation (TDC)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#resources">
   Resources
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mcan-related-collateral">
     MCAN Related Collateral
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
</div>
</div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
<script async>
  async function setTheme() {
    try {
      var colorScheme = await window.parent.getTirexTheme();
      var mode = colorScheme === 'dark' ? 'dark' : 'light';
      localStorage.setItem('mode', mode);
      document.documentElement.dataset.mode = mode;
      document.documentElement.dataset.theme = colorScheme;
    } catch (error) {
      console.error('Failed to set the theme:', error);
    }
  }

  setTheme();
</script>


  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>




<script type="text/javascript">
  function extractNodeValue(url) {
    try {
      const parsedUrl = new URL(url);
      if (parsedUrl.pathname === '/tirex/explore/node') {
        const searchParams = new URLSearchParams(parsedUrl.search);
        return searchParams.get('node');
      } else {
        return null;
      }
    } catch (error) {
      console.error("Invalid URL:", error);
      return null;
    }
  }

  // Get all links on the page
  const links = document.querySelectorAll('a');

  // Get the project name and replace spaces with underscores
  var projName = "C2000 Academy";

  // Attach a click event listener to each link
  links.forEach((link) => {
    link.addEventListener('click', (event) => {
      // Prevent the default link behavior
      event.preventDefault();

      const url = link.href;
      const match = url.match(/source\/.+$/);
      const localId = match ? match[0].replace(/\.html$/, '').replace(/[\/\\\.]/g, '_').toLowerCase() : null;

      const extractedNode = extractNodeValue(url);

      if (typeof window.parent.jumpToTirexNodeOnLocal === 'function') {
        window.parent.jumpToTirexNodeOnLocal(localId, null, null, {
            throwError: true
          })
          .catch((e) => {
            if (extractedNode !== null) {
              window.parent.jumpToTirexNode(extractedNode, {
                  throwError: true
                })
                .catch((e) => {
                  window.location.href = link.href;
                })
            }
            else {
              if (url.includes("e2e.ti.com") || url.includes("dev.ti.com/gallery/view")) {
              window.open(url, "_blank")
              } else {
              window.location.href = link.href;
            }}
          })
      } else {
        window.location.href = link.href;
      }
    });
  });
</script>
  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2023, Texas Instruments.<br>

</p>

  </div>
  
</div>
  </footer>
  </body>
</html>